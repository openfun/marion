
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The greatest PDF documents factory backend">
      
      
      
        <meta name="author" content="Open FUN (France Universite Numerique)">
      
      
        <link rel="canonical" href="https://openfun.github.io/marion/issuer/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.1">
    
    
      
        <title>Create an issuer - Marion</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.9299cb39.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#create_an_issuer" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Marion" class="md-header__button md-logo" aria-label="Marion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Marion
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Create an issuer
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/openfun/marion/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openfun/marion
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Marion" class="md-nav__button md-logo" aria-label="Marion" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Marion
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/openfun/marion/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openfun/marion
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_1" type="checkbox" id="__nav_1" >
      
      <label class="md-nav__link" for="__nav_1">
        Getting started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        User guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          User guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Create an issuer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Create an issuer
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#module_tree" class="md-nav__link">
    Module tree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#business_logic" class="md-nav__link">
    Business logic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document_templates" class="md-nav__link">
    Document templates
  </a>
  
    <nav class="md-nav" aria-label="Document templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using_the_document_template_debug_view" class="md-nav__link">
    Using the document template debug view
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issuer_configuration" class="md-nav__link">
    Issuer configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document_rendering" class="md-nav__link">
    Document rendering
  </a>
  
    <nav class="md-nav" aria-label="Document rendering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using_the_issuer_api" class="md-nav__link">
    Using the issuer API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using_the_documentrequest_django_model" class="md-nav__link">
    Using the DocumentRequest Django model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using_the_rest_api" class="md-nav__link">
    Using the REST API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issuer_testing" class="md-nav__link">
    Issuer testing
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        Settings
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Developer guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Developer guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Developer guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      <label class="md-nav__link" for="__nav_3_2">
        References
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="References" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          References
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sources/issuer/" class="md-nav__link">
        Issuer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sources/model/" class="md-nav__link">
        Model
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        About the project
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About the project" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          About the project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#module_tree" class="md-nav__link">
    Module tree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#business_logic" class="md-nav__link">
    Business logic
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document_templates" class="md-nav__link">
    Document templates
  </a>
  
    <nav class="md-nav" aria-label="Document templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using_the_document_template_debug_view" class="md-nav__link">
    Using the document template debug view
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issuer_configuration" class="md-nav__link">
    Issuer configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#document_rendering" class="md-nav__link">
    Document rendering
  </a>
  
    <nav class="md-nav" aria-label="Document rendering">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using_the_issuer_api" class="md-nav__link">
    Using the issuer API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using_the_documentrequest_django_model" class="md-nav__link">
    Using the DocumentRequest Django model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using_the_rest_api" class="md-nav__link">
    Using the REST API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#issuer_testing" class="md-nav__link">
    Issuer testing
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/openfun/marion/edit/master/docs/issuer.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="create_an_issuer">Create an issuer<a class="headerlink" href="#create_an_issuer" title="Permanent link">&para;</a></h1>
<p>Once Marion is installed, you will need to create one issuer per document type
you need to generate. Your issuers should stand in a python module that bundles
templates and the business logic required to build your documents. This module
can be distributed as a python package or a core Django application in your
Django project.</p>
<h2 id="module_tree">Module tree<a class="headerlink" href="#module_tree" title="Permanent link">&para;</a></h2>
<p>An example <code>shop</code> module tree follows:</p>
<div class="highlight"><pre><span></span><code>apps/shop
├── defaults.py
├── __init__.py
├── issuers
│   ├── __init__.py
│   └── invoice.py
├── static
│   └── shop
│       └── logo.svg
├── templates
│   └── shop
│       ├── invoice.css
│       └── invoice.html
└── tests
    └── issuers
        ├── __init__.py
        └── test_invoice.py
</code></pre></div>
<p>As you may have noticed if you are familiar with Django: the module tree looks
like a standard Django app (but without models, views and urls). Except for
the <code>static/{{ application_name }}</code> directory, the project tree is only a
recommendation, feel free to organize things the way you like.</p>
<p>In the proposed project tree:</p>
<ul>
<li><code>defaults.py</code> contains default values to configure your issuer,</li>
<li><code>issuers</code> module contains issuers (one file per issuer),</li>
<li><code>static/{{ application_name }}</code> is the place to store images that will be
  embedded in your rendered documents,</li>
<li><code>templates/{{ application_name }}</code> contains your HTML and CSS templates that
  will be used to generate your documents, and,</li>
<li><code>tests/issuers</code> directory will ship tests for your issuers (business logic).</li>
</ul>
<h2 id="business_logic">Business logic<a class="headerlink" href="#business_logic" title="Permanent link">&para;</a></h2>
<p>Now that your project tree is ready, you will need to write code for your
<code>Invoice</code> issuer. Before writing code, we will have to explain a key concept in
Marion&rsquo;s design: an issuer uses a <em>context query</em> to fetch a <em>context</em> that
will be used to substitute variables in your templates. In other words, this
context query is a collection of key-values that is required to build or fetch
a collection of key-values that will serve as the context.</p>
<p>An example issuer code follows (it will be commented in
details later):</p>
<div class="highlight"><pre><span></span><code><span class="c1"># apps/shop/issuers/invoice.py</span>

<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">uuid</span> <span class="kn">import</span> <span class="n">UUID</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">from</span> <span class="nn">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span>

<span class="kn">from</span> <span class="nn">marion.issuers.base</span> <span class="kn">import</span> <span class="n">AbstractDocument</span>


<span class="k">class</span> <span class="nc">Customer</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Customer pydantic model&quot;&quot;&quot;</span>

   <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">class</span> <span class="nc">Invoice</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Invoice pydantic model&quot;&quot;&quot;</span>

   <span class="n">invoice_id</span><span class="p">:</span> <span class="n">UUID</span>
   <span class="n">customer</span><span class="p">:</span> <span class="n">Customer</span>
   <span class="n">total</span><span class="p">:</span> <span class="nb">float</span>


<span class="k">class</span> <span class="nc">ContextModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Context pydantic model&quot;&quot;&quot;</span>

   <span class="n">invoice</span><span class="p">:</span> <span class="n">Invoice</span>


<span class="k">class</span> <span class="nc">ContextQueryModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Context query pydantic model&quot;&quot;&quot;</span>

   <span class="n">order_id</span><span class="p">:</span> <span class="n">UUID</span>


<span class="k">class</span> <span class="nc">Invoice</span><span class="p">(</span><span class="n">AbstractDocument</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Invoice issuer&quot;&quot;&quot;</span>

   <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MyShop&quot;</span><span class="p">,</span> <span class="s2">&quot;invoice&quot;</span><span class="p">]</span>

   <span class="n">context_model</span> <span class="o">=</span> <span class="n">ContextModel</span>
   <span class="n">context_query_model</span> <span class="o">=</span> <span class="n">ContextQueryModel</span>

   <span class="n">css_template_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;shop/invoice.css&quot;</span><span class="p">)</span>
   <span class="n">html_template_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;shop/invoice.html&quot;</span><span class="p">)</span>

   <span class="k">def</span> <span class="nf">fetch_context</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
      <span class="sd">&quot;&quot;&quot;Write your business logic to fetch the context here&quot;&quot;&quot;</span>

      <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
         <span class="sa">f</span><span class="s2">&quot;https://www.myshop.com/api/orders/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">context_query</span><span class="o">.</span><span class="n">order_id</span><span class="si">}</span><span class="s2">&quot;</span>
      <span class="p">)</span>
      <span class="n">order</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>

      <span class="k">return</span> <span class="p">{</span>
         <span class="s2">&quot;invoice&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;invoice_id&quot;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">),</span>
            <span class="s2">&quot;customer&quot;</span><span class="p">:</span> <span class="p">{</span>
               <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;customer&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fullname&quot;</span><span class="p">),</span>
            <span class="p">},</span>
            <span class="s2">&quot;total&quot;</span><span class="p">:</span> <span class="n">order</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;total&quot;</span><span class="p">),</span>
         <span class="p">}</span>
      <span class="p">}</span>

   <span class="k">def</span> <span class="nf">get_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot;Generate a PDF title that depends on the context&quot;&quot;&quot;</span>
      <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Invoice ref. </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">invoice</span><span class="o">.</span><span class="n">invoice_id</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>After reading this simplified piece of code, you may have noticed that:</p>
<ol>
<li>your issuer class <strong>should</strong> inherit from the
   <code>marion.issuers.base.AbstractDocument</code> class,</li>
<li>your issuer class <strong>should</strong> implement the <code>fetch_context</code> method,</li>
<li>the <code>fetch_context</code> method <strong>should</strong> return a dictionnary of the context
   that will be used to render your templates (more on this later),</li>
<li>you <strong>should</strong> define <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a>
   models to validate data from your context and context query,</li>
</ol>
<p>Note that documents metadata such as the <code>title</code>, <code>keywords</code> or <code>authors</code> can
be statically set as an issuer class attribute (<em>e.g.</em> <code>title</code>) or dynamically
using the corresponding method (<em>e.g.</em> <code>get_title()</code> for the <code>title</code> attribute
in our example). For reference, see the
<a href="../sources/issuer/"><code>marion.issuers.base.PDFFileMetadataMixin</code></a> mixin
implementation.</p>
<h2 id="document_templates">Document templates<a class="headerlink" href="#document_templates" title="Permanent link">&para;</a></h2>
<p>While writing our issuer class, we&rsquo;ve taken care of the business logic to
collect all required information (context variables) that will be integrated to
the issuer document template. The second step is to implement the logical
structure (HTML) and the design (CSS) of our document.</p>
<p>While writing your document template, you must keep in mind that you are
designing a printed document, <em>e.g.</em> writing CSS rules for the <code>print</code> media.</p>
<p>You should also note that both your HTML and CSS files are Django templates
that are consequently context-aware and versatile.</p>
<p>Simplified example template files for the <code>Invoice</code> issuer are presented below.</p>
<div class="highlight"><pre><span></span><code><span class="c">&lt;!-- apps/shop/templates/shop/invoice.html --&gt;</span>

<span class="cp">{%</span> <span class="k">load</span> <span class="nv">i18n</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span>

<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">debug</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
      <span class="cp">{{</span> <span class="nv">css</span> <span class="cp">}}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;invoice&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">header</span><span class="p">&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            Company matters</span>
<span class="c">        --&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;logo&quot;</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nt">img</span>
            <span class="na">src</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">debug</span> <span class="o">|</span> <span class="nf">yesno</span><span class="s2">:&quot;,file://&quot;</span> <span class="cp">}}{%</span> <span class="k">static</span> <span class="s2">&quot;shop/logo.svg&quot;</span> <span class="cp">%}</span><span class="s">&quot;</span>
            <span class="na">alt</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">&quot;company logo&quot;</span> <span class="cp">%}</span><span class="s">&quot;</span>
          <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">article</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;order&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;invoice-id&quot;</span><span class="p">&gt;</span>
          <span class="cp">{%</span> <span class="k">trans</span> <span class="s2">&quot;Invoice reference:&quot;</span> <span class="cp">%}</span> <span class="cp">{{</span> <span class="nv">invoice.invoice_id</span> <span class="cp">}}</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;customer&quot;</span><span class="p">&gt;</span>
          <span class="cp">{{</span> <span class="nv">invoice.customer.name</span> <span class="cp">}}</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;total-amount&quot;</span><span class="p">&gt;</span>
          <span class="cp">{{</span> <span class="nv">invoice.total</span> <span class="cp">}}</span> <span class="ni">&amp;euro;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">article</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">footer</span><span class="p">&gt;</span>
        <span class="c">&lt;!--</span>
<span class="c">            Contact informations</span>
<span class="c">        --&gt;</span>
      <span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<blockquote>
<p>If you are familiar with Django templates, <code>debug</code> blocks usage or conditions
can be confusing at first sight. We will explain those in the next
subsection.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="c">/* apps/shop/templates/shop/invoice.css */</span>

<span class="c">/* load extra fonts */</span>
<span class="p">@</span><span class="k">import</span> <span class="nt">url</span><span class="o">(</span><span class="s2">&quot;https://fonts.googleapis.com/css2?family=Open+Sans&quot;</span><span class="o">)</span><span class="p">;</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="k">font-family</span><span class="p">:</span> <span class="s2">&quot;Open Sans&quot;</span><span class="p">,</span> <span class="kc">sans-serif</span><span class="p">;</span>
  <span class="k">font-size</span><span class="p">:</span> <span class="mi">11</span><span class="kt">pt</span><span class="p">;</span>
  <span class="k">color</span><span class="p">:</span> <span class="mh">#222</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="k">media</span> <span class="nt">print</span> <span class="p">{</span>
  <span class="c">/* ----------------------</span>
<span class="c">   * Reset margins for media</span>
<span class="c">   * ---------------------- */</span>
  <span class="p">@</span><span class="k">page</span> <span class="p">{</span>
    <span class="nt">size</span><span class="o">:</span> <span class="nt">A4</span> <span class="nt">landscape</span><span class="o">;</span>
    <span class="nt">margin</span><span class="o">:</span> <span class="nt">0</span><span class="o">;</span>
    <span class="nt">padding</span><span class="o">:</span> <span class="nt">0</span><span class="o">;</span>
  <span class="p">}</span>

  <span class="nt">body</span> <span class="p">{</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">background</span><span class="p">:</span> <span class="mh">#ffbe0b</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="o">*</span> <span class="p">{</span>
    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="c">/* ----------------------</span>
<span class="c">   * Add custom styles below</span>
<span class="c">   * ---------------------- */</span>
  <span class="p">.</span><span class="nc">invoice</span> <span class="p">{</span>
    <span class="c">/* [...] */</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="using_the_document_template_debug_view">Using the document template debug view<a class="headerlink" href="#using_the_document_template_debug_view" title="Permanent link">&para;</a></h3>
<p>Integrating a document template can be time consuming if you need to render it
as a PDF every time you want to check how it looks like. To ease your life,
we&rsquo;ve cooked a template debug view that can be activated in your development
environment by modifiying your root URLs configuration as follow:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># myproject.myproject.urls</span>

<span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>

<span class="c1"># [...]</span>

<span class="k">if</span> <span class="n">settings</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">:</span>
    <span class="n">urlpatterns</span> <span class="o">+=</span> <span class="p">[</span><span class="n">path</span><span class="p">(</span><span class="s2">&quot;__debug__/&quot;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s2">&quot;marion.urls.debug&quot;</span><span class="p">))]</span>
</code></pre></div>
<blockquote>
<p>We advice you not to activate this in production, it should only be active
for development.</p>
</blockquote>
<p>By using this view, you will be able to &ldquo;see&rdquo; your document in your browser as
a normal web page at the following URL:
<a href="http://localhost:8000/__debug__/templates/">http://localhost:8000/__debug__/templates/</a></p>
<p>Two GET request parameters are required to point to your template:</p>
<ol>
<li><code>issuer</code>: the target issuer path</li>
<li><code>context</code>: the issuer context (as resulting from the issuer&rsquo;s
   <code>fetch_context</code> method)</li>
</ol>
<p>A complete debug template URL example may look like:</p>
<div class="highlight"><pre><span></span><code>http://localhost:8000/__debug__/templates/?issuer=apps.shop.issuers.invoice.Invoice&amp;context=%7B%22invoice%22%3A+%7B%22invoice-id%22%3A+%22d972fef9%22%7D
</code></pre></div>
<p>Note that the JSON-serialized <code>context</code> should be URL encoded. This can be
achieved using the following python snippet:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">urllib.parse</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;context.json&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">example</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">quote_plus</span><span class="p">(</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">example</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div>
<p>As mentionned earlier, you should keep in mind that the media that will be used
to render your document is a printer, so you should <strong>enable print media
emulation</strong> in the developer tools of your web browser to have a better idea of
what it will look like once rendered as a PDF.</p>
<p>In expected conditions (outside from a Django view context), Marion generates a
PDF file using separated HTML and CSS content. Linked files (<em>e.g.</em> embedded
images) are expected to be referenced using the <code>file://</code> protocol (a custom
url fetcher will integrate those files in the final document). But, when using
this debug view, we need to inject CSS styles in the template and serve static
files by Django to display them in the browser. This is why we add a <code>debug</code>
variable to the Django context. This variable should be used to add CSS content
in the debug view:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="cp">{%</span> <span class="k">if</span> <span class="nv">debug</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="cp">{{</span> <span class="nv">css</span> <span class="cp">}}</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

  <span class="c">&lt;!-- [...] --&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<p>And display images:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">img</span>
  <span class="na">src</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">debug</span> <span class="o">|</span> <span class="nf">yesno</span><span class="s2">:&quot;,file://&quot;</span> <span class="cp">}}{%</span> <span class="k">static</span> <span class="s2">&quot;shop/logo.svg&quot;</span> <span class="cp">%}</span><span class="s">&quot;</span>
  <span class="na">alt</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{%</span> <span class="k">trans</span> <span class="s2">&quot;company logo&quot;</span> <span class="cp">%}</span><span class="s">&quot;</span>
<span class="p">/&gt;</span>
</code></pre></div>
<h2 id="issuer_configuration">Issuer configuration<a class="headerlink" href="#issuer_configuration" title="Permanent link">&para;</a></h2>
<p>Once written, we should declare distributed application issuers:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># apps/shop/defaults.py</span>

<span class="kn">from</span> <span class="nn">django.db.models</span> <span class="kn">import</span> <span class="n">TextChoices</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">gettext_lazy</span> <span class="k">as</span> <span class="n">_</span>


<span class="k">class</span> <span class="nc">ShopDocumentIssuerChoices</span><span class="p">(</span><span class="n">TextChoices</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List active document issuers.&quot;&quot;&quot;</span>

    <span class="n">INVOICE</span> <span class="o">=</span> <span class="s2">&quot;apps.shop.issuers.invoice.Invoice&quot;</span><span class="p">,</span> <span class="n">_</span><span class="p">(</span><span class="s2">&quot;Invoice&quot;</span><span class="p">)</span>
</code></pre></div>
<p>And activate them in our Django settings:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pyproject/myproject/settings.py</span>

<span class="c1"># Add the shop app</span>
<span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;django.contrib.admin&quot;</span><span class="p">,</span>
    <span class="c1"># [...]</span>
    <span class="s2">&quot;rest_framework&quot;</span><span class="p">,</span>
    <span class="s2">&quot;marion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;apps.shop&quot;</span><span class="p">,</span>
<span class="p">]</span>

<span class="c1"># Activate shop issuers</span>
<span class="n">MARION_DOCUMENT_ISSUER_CHOICES_CLASS</span> <span class="o">=</span> <span class="s2">&quot;apps.shop.defaults.ShopDocumentIssuerChoices&quot;</span>
</code></pre></div>
<p>Only issuers listed in the <code>ShopDocumentIssuerChoices</code> can be used in the
current Django project. If you need more issuers, you should declare them in
the <code>ShopDocumentIssuerChoices</code> enum-like object or declare a new enum listing
all allowed issuers for your project.</p>
<blockquote>
<p>Note that modifying this setting requires to create a new database migration
as this will change choices of the <code>DocumentRequest.issuer</code> field.</p>
</blockquote>
<h2 id="document_rendering">Document rendering<a class="headerlink" href="#document_rendering" title="Permanent link">&para;</a></h2>
<p>Once your issuer has been implemented and activated, you can generate the
corresponding PDF file using either the issuer API, the <code>DocumentRequest</code>
model or the REST API endpoint. In the first scenario, the generation of your
document will not be tracked as a document request in your database.</p>
<h3 id="using_the_issuer_api">Using the issuer API<a class="headerlink" href="#using_the_issuer_api" title="Permanent link">&para;</a></h3>
<p>To generate a document, you will need to instantiate the corresponding issuer
with an appropriate context query, and then call the <code>create()</code> method:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">apps.shop.issuers.invoice.Invoice</span>

<span class="n">invoice</span> <span class="o">=</span> <span class="n">Invoice</span><span class="p">(</span>
   <span class="n">context_query</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="s2">&quot;7866454a-600e-434a-a546-04a286b208db&quot;</span><span class="p">}</span>
<span class="p">)</span>

<span class="c1"># Generate the PDF file</span>
<span class="n">invoice</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
</code></pre></div>
<p>Your document should have been rendered in a PDF file created in the
<code>MARION_DOCUMENTS_ROOT</code> setting path. For reference, see the
<a href="../sources/issuer/"><code>marion.issuers.base.AbstractDocument</code></a> class.</p>
<h3 id="using_the_documentrequest_django_model">Using the <code>DocumentRequest</code> Django model<a class="headerlink" href="#using_the_documentrequest_django_model" title="Permanent link">&para;</a></h3>
<p>If you want to track documents creation in your database, you should use
Marion&rsquo;s <code>DocumentRequest</code> model in your views:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># apps/shop/views.py</span>

<span class="kn">from</span> <span class="nn">marion.models</span> <span class="kn">import</span> <span class="n">DocumentRequest</span>


<span class="k">def</span> <span class="nf">payment</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Payment view&quot;&quot;&quot;</span>

    <span class="n">order_id</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;order_id&quot;</span><span class="p">)</span>

    <span class="n">invoice</span> <span class="o">=</span> <span class="n">DocumentRequest</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
      <span class="n">issuer</span><span class="o">=</span><span class="s2">&quot;apps.shop.issuers.invoice.Invoice&quot;</span><span class="p">,</span>
      <span class="n">context_query</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;order_id&quot;</span><span class="p">:</span> <span class="n">order_id</span><span class="p">}</span>
   <span class="p">)</span>

   <span class="c1"># [...]</span>
</code></pre></div>
<p>Your document should have been rendered in a PDF file created in the
<code>MARION_DOCUMENTS_ROOT</code> setting path. For reference, see the
<a href="../sources/model/"><code>marion.models.DocumentRequest</code></a> class and the
<a href="../sources/issuer/"><code>marion.issuers.base.AbstractDocument</code></a> class.</p>
<h3 id="using_the_rest_api">Using the REST API<a class="headerlink" href="#using_the_rest_api" title="Permanent link">&para;</a></h3>
<p>If you have configured Marion&rsquo;s urls in your project, you can use the document
request view set to get, list or create a new document:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a new document using the invoice issuer</span>
$ http POST http://localhost:8000/api/documents/requests/ <span class="se">\</span>
    <span class="nv">issuer</span><span class="o">=</span><span class="s2">&quot;apps.shop.issuers.invoice.Invoice&quot;</span> <span class="se">\</span>
    <span class="nv">context_query</span><span class="o">=</span><span class="s1">&#39;{&quot;order_id&quot;: &quot;7866454a-600e-434a-a546-04a286b208db&quot;}&#39;</span>
</code></pre></div>
<p>You should have a <code>HTTP 200 OK</code> response. Yatta!</p>
<p><img alt="Yatta" src="https://media.giphy.com/media/x2z9nswqAfpp6/giphy.gif" /></p>
<p>Once created, check the document request ID (and the corresponding document) by
listing created objects <em>via</em>:</p>
<div class="highlight"><pre><span></span><code>$ http GET http://localhost:8000/api/documents/requests/
</code></pre></div>
<h2 id="issuer_testing">Issuer testing<a class="headerlink" href="#issuer_testing" title="Permanent link">&para;</a></h2>
<p>Don&rsquo;t forget to test your business logic implemented in the <code>fetch_context</code>
method of your issuer. We use <code>pytest</code> along with
<a href="https://hypothesis.readthedocs.io/en/latest/">hypothesis</a> as it has builtin
support for <a href="https://pydantic-docs.helpmanual.io/">Pydantic</a> models.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../install/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Installation
            </div>
          </div>
        </a>
      
      
        <a href="../settings/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Settings
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            2021-present GIP FUN MOOC
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.7353b375.min.js"></script>
      
    
  </body>
</html>